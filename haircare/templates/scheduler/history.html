{% extends 'core/base.html' %}

{% block title %}Schedule History{% endblock %}

{% block content %}
<div class="container">
    <div class="page-header">
        <h1>üìä Your Hair Care History</h1>
        <a href="{% url 'calendar_home' %}" class="btn-secondary">‚Üê Back to Calendar</a>
    </div>

    <!-- Stats Summary -->
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem; margin-bottom: 3rem;">
        <div style="background: linear-gradient(135deg, var(--primary), var(--primary-dark)); padding: 2rem; border-radius: var(--radius-xl); color: white; text-align: center;">
            <div style="font-size: 3rem; font-weight: 900; margin-bottom: 0.5rem;">{{ total_completed }}</div>
            <div style="font-size: 1.125rem; opacity: 0.9;">Total Completed</div>
        </div>
        <div style="background: linear-gradient(135deg, var(--secondary), var(--secondary-dark)); padding: 2rem; border-radius: var(--radius-xl); color: white; text-align: center;">
            <div style="font-size: 3rem; font-weight: 900; margin-bottom: 0.5rem;">{{ this_week }}</div>
            <div style="font-size: 1.125rem; opacity: 0.9;">This Week</div>
        </div>
        <div style="background: linear-gradient(135deg, var(--accent-purple), var(--primary)); padding: 2rem; border-radius: var(--radius-xl); color: white; text-align: center;">
            <div style="font-size: 3rem; font-weight: 900; margin-bottom: 0.5rem;">{{ this_month }}</div>
            <div style="font-size: 1.125rem; opacity: 0.9;">This Month</div>
        </div>
    </div>

    <!-- Completion Log -->
    <h2 style="margin-bottom: 2rem;">Recent Activity</h2>
    
    {% if logs %}
    <div style="display: grid; gap: 1.5rem;">
        {% for log in logs %}
        <div class="tip-card">
            <div style="display: flex; justify-content: space-between; align-items: start;">
                <div style="flex: 1;">
                    <h3 style="color: var(--text-primary); margin-bottom: 0.5rem;">
                        {{ log.schedule.custom_event_name|default:log.schedule.get_event_type_display }}
                    </h3>
                    <div style="display: flex; gap: 1rem; margin: 0.75rem 0; flex-wrap: wrap; align-items: center;">
                        <span style="color: var(--text-secondary);">
                            üìÖ {{ log.completed_date|date:"M d, Y" }}
                        </span>
                        <span style="color: var(--text-secondary);">
                            üïê {{ log.completed_time|time:"g:i A" }}
                        </span>
                        {% if log.mood %}
                            <span class="tag">{{ log.get_mood_display }}</span>
                        {% endif %}
                        {% if log.hair_condition %}
                            <span style="color: var(--accent-yellow);">
                                {% for i in "12345" %}
                                    {% if forloop.counter <= log.hair_condition %}‚≠ê{% else %}‚òÜ{% endif %}
                                {% endfor %}
                            </span>
                        {% endif %}
                    </div>
                    {% if log.notes %}
                        <p style="color: var(--text-secondary); margin-top: 1rem; line-height: 1.7;">
                            {{ log.notes }}
                        </p>
                    {% endif %}
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="tip-card" style="text-align: center; padding: 3rem;">
        <p style="font-size: 1.25rem; color: var(--text-muted);">
            No activity yet. Complete your first task to see it here!
        </p>
    </div>
    {% endif %}
</div>
{% endblock %}